#include <string.h>
#include <inttypes.h>

#include <prng.h>

#include "testsupp.h"

#define IDIM    8
#define JDIM    8

static const uint64_t rng_dat[IDIM][JDIM] = {
    {   12543970707110144703ULL, 9518767838499841048ULL, 13900035526540722875ULL, 6996297813691152402ULL,
        17550374167678331219ULL, 69987067683266599ULL, 17171229644356305274ULL, 16747315125357858866ULL,
    },
    {   3635815201545861042ULL, 11038529536880396234ULL, 15520069101918774568ULL, 14774128903121938547ULL,
        119398576293348361ULL, 8269230604243458530ULL, 12492129634885439908ULL, 4682542096173129436ULL,
    },
    {   2798367332711517185ULL, 4970381944724681329ULL, 5541627722209442125ULL, 10597334853975946305ULL,
        6867290653371896399ULL, 4268923762995193210ULL, 3208338381779973471ULL, 14876885685287568241ULL,
    },
    {   16500621315873782521ULL, 14258465764548374313ULL, 7087073040411818076ULL, 5590731852051406620ULL,
        15132839439594699655ULL, 11083984554825845413ULL, 1344966269838761084ULL, 7686541891562859700ULL,
    },
    {   10507044888132745853ULL, 14914247942702876021ULL, 17286767403180197610ULL, 915974094043943751ULL,
        14048347129306581096ULL, 9275018437783832577ULL, 12040627595103464506ULL, 16466068997245712406ULL,
    },
    {   13632996779894111303ULL, 9501829148128974568ULL, 11094035229004987022ULL, 12401180818029314536ULL,
        12261453579023367146ULL, 5621769555507510586ULL, 2545334534405599392ULL, 15764580529649935181ULL,
    },
    {   9525254503111765206ULL, 373783897600294495ULL, 18148968064490581193ULL, 16367433035610833983ULL,
        11628913681131682132ULL, 5301947484946347182ULL, 4042176681693589235ULL, 6877514895399713354ULL,
    },
    {   7497937546618516930ULL, 5078711826511630236ULL, 2010947805804211309ULL, 499016284232600576ULL,
        12246061361426366317ULL, 884916831856457790ULL, 9575924205717715939ULL, 5036570368397940790ULL,
    },
};

REGISTER( prng_test )
{
    int i, j, err = 0;
    uint64_t x = 0xA6ULL;
    prng_random_ctx_t ctx;

    for ( i = 0; i < IDIM; ++i )
    {
        prng_srandom_r( &ctx, x << (i*64/IDIM) );
        for ( j = 0; j < JDIM; ++j )
            if ( rng_dat[i][j] != prng_random_r( &ctx ) )
                ++err;
    }
    if ( !err )
        PASS( "prng %d/%d ok", i*j, i*j );
    else
        FAIL( "prng %d/%d failed", err, i*j );
    return err;
}

/* EOF */
